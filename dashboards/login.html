<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food delivery</title>
  <link rel="stylesheet" href="login.css">
</head>
<body>
 
  <header id="head">
    <p>Your favorite Dishes, Delivered to you</p>
    <button id="chef-login" onclick="chef()"> Login as chef</button>
  </header>


  <main id="main">
    <div id="login-box">
      <form id="login-user">
        <label for="ph-no">Enter Mobile Number</label>
        <input type="number" id="ph-no" placeholder="Mobile Number" required>
        
        <label for="pass">Enter your password</label>
        <input type="password" id="pass" placeholder="Password" required>
        
        <button id="login" type="submit">Login</button>
      </form>
    </div>
    <div id="register">
      <a href="register.html">New User? Click to register</a>
    </div>
  </main>
  <script>
    var c=document.getElementById("chef-login");
    c.addEventListener("click", function() {
    window.location.href = "chef.html";
  });
  const loginForm = document.getElementById("login-user");

loginForm.addEventListener("submit", async function(event) {
  event.preventDefault(); 

  const mobile = document.getElementById("ph-no").value;
  const password = document.getElementById("pass").value;

  
  const credentials = {
    mobile: mobile,
    password: password
  };

  try {
    const response = await login(credentials); 
    console.log(response);

    if (response.success) {
      alert("Login successful!");
      
      window.location.href = "register.html";
    } else {
      alert("Login failed: " + response.message);
    }
  } catch (error) {
    console.error("Error:", error);
    alert("Incorrect Password or mobile number");
  }
});


const login = async (credentials) => {
  const response = await fetch('https://wild-ruth-butterfly-charter.trycloudflare.com/api/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(credentials)
  });
  const data = await response.json();
  if (data.success) {
    localStorage.setItem('token', data.token);
  }
  return data;
};
  
  </script>

 
</body>
</html>
